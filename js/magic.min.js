
$(document).ready(function(){$('div.jqueryError').hide();$('div.loading').hide();$('div.error').live('click',function(){$(this).fadeOut();});var reloadTimeout=1000;function checkRedirection(data){if(data.search('<a href="login">')!=-1){window.location="login";}}
function loadHome(){showSpinner();$('td#subnets').hide();$('div.content').hide().load('site/home/home.php',function(){hideSpinner();}).fadeIn('fast');}
function loadSubnets(section){showSpinner();var hash=document.location.toString();var slaveId=hash.split('|')[1];$('td#subnets').slideDown();$.post('site/subnets.php',{section:section,slaveId:slaveId},function(data){$('div.subnets').html(data).slideDown('fast');hideSpinner();checkRedirection(data);});$('div.content').html('<h4>Please select Subnet from left menu!</h4>');}
function loadipaddresses(subnetId,section){$('div.content').fadeIn('fast');showSpinner();$.post('site/ipAddressPrint.php',{subnetId:subnetId},function(data){$('div.content').html(data);hideSpinner();checkRedirection(data);});}
function loadSlaveIPAddresses(subnetId){showSpinner();$.post('site/ipAddressSlavesPrint.php',{subnetId:subnetId},function(data){$('div.content').html(data).fadeIn('fast');hideSpinner();checkRedirection(data);});}
function modifyipaddress(action,id,$subnetId){postdata="action="+action+"&id="+id+"&subnetId="+$subnetId;$.post('site/modifyIpAddress.php',postdata,function(data){$('div.addnew_check').slideDown('fast');$('div.addnew').removeClass('mail').html(data).slideDown('fast');$('.tooltipTop').hide();});}
function modifyipaddresscheck(){showSpinner();section=$('table.newSections li.active').attr('id');postdata=$('form.editipaddress').serialize()+"&section="+section;subnetId=$('table.subnets tr.selected').attr('id');$.post('site/modifyIpAddressCheck.php',postdata,function(data){$('div.addnew_check').html(data);$('div.addnew_check').slideDown('fast');hideSpinner();if(data.search("error")==-1){setTimeout(function(){loadipaddresses(subnetId);parameter=null;},reloadTimeout);}});}
function loadCSVImport(){showSpinner();$.post('site/admin/CSVimport.php',function(data){$('div.ipaddresses_overlay').html(data);hideSpinner();});}
function hashLoadSubnets(section,subpage){loadSubnets(section);setTimeout(function(){loadipaddresses(subpage,section);parameter=null;},100);setTimeout(function(){addActiveSubnetClass(subpage);parameter=null;},100);}
function hashLoadAdmin(section,subpage){loadSubnets(section);setTimeout(function(){loadAdminSubpage(subpage);parameter=null;},100);setTimeout(function(){addActiveAdminClass(subpage);parameter=null;},100);}
function addActiveSubnetClass(subpage){$('table.subnets tr.'+subpage).addClass('selected');}
function addActiveAdminClass(subpage){$('table.admin tr.'+subpage).addClass('selected');}
function loadAdminSubpage(subpage){$('td#subnets').slideDown();showSpinner();$('div.content').load('site/admin/'+subpage+'.php',function(data){hideSpinner();checkRedirection(data);}).fadeIn('fast');}
function reloadSections(){$.post('site/sections.php',function(data){$('div.sections').html(data).fadeIn('fast');});}
function showManageSubnetsBody(sectionId){$('table.manageSubnets tbody').hide();$('div.manageSubnetEdit').hide();$('table.manageSubnets tbody.'+sectionId).show('fast');checkRedirection(data);}
function showManageSubnetsPageAndBody(subpage,sectionId){loadAdminSubpage(subpage);setTimeout(function(){showManageSubnetsBody(sectionId);parameter=null;},50);hideSpinner();}
function loadUserModSubpage(){showSpinner();$('div.content').load('site/admin/userMod.php',function(){hideSpinner();}).fadeIn('fast');}
function loadAdminIPRequestSubpage(){hashLoadAdmin("Administration","manageRequests");}
function randomPass(){chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";pass="";for(x=0;x<10;x++){i=Math.floor(Math.random()*62);pass+=chars.charAt(i);}
return pass;}
function loadToolsMenu(subPage){$('div.subnets').load('site/tools/toolsMenu.php').slideDown('fast',function(){$('table.menu tr').removeClass('selected');$('table.menu a#'+subPage).closest('tr').addClass('selected');});}
function loadToolsSubpage(subPage){showSpinner();$('div.content').load('site/tools/'+subPage+'.php').slideDown('fast',function(){$('table.menu tr').removeClass('selected');$('table.menu a#'+subPage).closest('tr').addClass('selected');hideSpinner();});}
function loadToolsMenuAndSubpage(subPage){$('td#subnets').slideDown();$('table.menu tr').removeClass('selected');loadToolsMenu(subPage);setTimeout(function(){loadToolsSubpage(subPage);parameter=null;},100);}
function loadSearchPage(searchTerm){document.location.href="#tools|search";showSpinner();$('td#subnets').slideDown();loadToolsMenu('search');$.post('site/tools/search.php',searchTerm,function(data){$('div.content').html(data).fadeIn('fast');hideSpinner();});}
function updateSearchPage(searchTerm){showSpinner();$.post('site/tools/search.php',searchTerm,function(data){$('div.content').html(data).fadeIn('fast');hideSpinner();});}
function showSpinner(){$('div.loading').show();}
function hideSpinner(){$('div.loading').fadeOut('fast');}
$('table.normalTable tr[class!=th]').live("mouseover mouseout",function(event){if(event.type=='mouseover')
$(this).addClass('hover');else
$(this).removeClass('hover');});var hash=document.location.toString();if(hash.match('#'))
{var section=hash.split('#')[1];var subpage=section.split('|')[1];var section2=section.split('|')[0];if(subpage){$('table.newSections li[section="'+section2+'"]').closest('li').addClass('active');}
else{$('table.newSections li[section="'+section+'"]').closest('li').addClass('active');}
if(hash.indexOf("login")!=-1){}
else if(section.length===0){loadHome();}
else if(section.indexOf("tools")!=-1){if(subpage)
loadToolsMenuAndSubpage(subpage);else
loadToolsMenu(section);}
else if(section.indexOf("Administration")!=-1){if(subpage)
hashLoadAdmin(section2,subpage);else
loadSubnets(section);}
else{if(subpage)
hashLoadSubnets(section2,subpage);else
loadSubnets(section);}}
else
loadHome();$('table.newSections ul li, table.newSections td#Administration, table.newSections td#instructions').live('click',function(){sectionName=$(this).attr('section');sectionId=$(this).attr('id');document.location.href="#"+sectionName;$('table.newSections ul li').removeClass('active');$(this).addClass('active');if(sectionId=="instructions"){loadToolsMenuAndSubpage(sectionId);}
else{loadSubnets(sectionId);}});$('div.header a').click(function(){loadHome();});$('div.adminMenuDropdown dd').live('click',function(){sectionName=$(this).attr('section');subpage=$(this).attr("id");document.location.href="#"+sectionName+"|"+subpage;hashLoadAdmin('Administration',subpage);});$('table.newSections td#Administration').live("mouseover mouseout",function(event){if(event.type=="mouseover"){$('div.adminMenuDropdown').stop(true,true).fadeIn('fast');}
else{$('div.adminMenuDropdown').delay(500).fadeOut('fast');}});$('div.adminMenuDropdown dd').live("mouseenter",function(){$('div.adminMenuDropdown').stop(true,true);$('div.adminMenuDropdown').show();});$('div.adminMenuDropdown').live("mouseleave",function(){$(this).delay(300).fadeOut('fast');});$('table.subnets tr[class!=th]').live("mouseover mouseout",function(event){if(event.type=='mouseover'){$(this).addClass('hover');$(this).children('td').children('img').attr("src","css/images/expandHover.png");}
else{$(this).removeClass('hover');$(this).children('td').children('img').attr("src","css/images/expand.png");}});$('table.subnets tr[class!=th] dd[class!=slavesToggle]').live("click",function(){subnet=$(this).attr('id');link=$(this).attr('section');document.location.href="#"+link;$('table.subnets tr').removeClass('selected');$(this).closest('tr').addClass('selected');loadipaddresses(subnet);});$('table.subnets tr[class!=th] dd.slavesToggle').live("click",function(){var masterId=$(this).attr('id');loadSlaveIPAddresses(masterId);$('div.slaveSubnets-'+masterId).slideDown('fast');$('div.tooltip,div.tooltipLeft,div.tooltipTop').hide();});$('table.subnets td.plusSubnet').live("click",function(){sectionId=$("table.newSections li.active").attr('id');postdata="sectionId="+sectionId+"&subnetAction=Add&location=subnets";loadAddSectionFromSubnets(postdata);});$('img.csvExport').live("click",function(){subnetId=$(this).attr('subnetId');$("div.dl").remove();$('div.exportDIV').append("<div style='display:none' class='dl'><iframe src='site/admin/exportSubnet.php?subnetId="+subnetId+"'></iframe></div>");});$('img.csvImport').live("click",function(){loadCSVImport();$('table.ipaddress_subnet div.addnew').slideUp('fast');});$('input#csvimportcheck').live('click',function(){showSpinner();var filetype=$('span.fname').html();$.post('site/admin/CSVimportShowFile.php',{filetype:filetype},function(data){$('div.csvimportverify').html(data).slideDown('fast');hideSpinner();});});$('th.hideSubnets').live('click',function(){$('table.content td#subnets, .tooltipLeft').fadeOut('fast');});$('img.structure').live('click',function(){var Id=$(this).attr('subnetId');$('div.slaveSubnets').not('div.slaveSubnets-'+Id).slideUp('fast');$('div.slaveSubnets-'+Id).slideToggle('fast');});$('input#csvImportNo').live('click',function(){$('div.csvimportverify').hide('fast');});$('input#csvImportYes').live('click',function(){showSpinner();var filetype=$('span.fname').html();var xlsSubnetId=$('table.subnets  tr.selected').attr('id');var postData="subnetId="+xlsSubnetId+"&filetype="+filetype;$.post('site/admin/CSVimportSubmit.php',postData,function(data){$('div.csvImportResult').html(data).slideDown('fast');hideSpinner();if(data.search("error")==-1){setTimeout(function(){loadipaddresses(xlsSubnetId);parameter=null;},reloadTimeout);}});});$('form#manageSubnetEditFromSubnets').live('submit',function(){subnetData=$(this).serialize();$.post("site/admin/manageSubnetEditResult.php",subnetData,function(data){$('div.manageSubnetEditResult').html(data).slideDown('fast');if(data.search("error")==-1){showSpinner();sectionId=$("table.newSections li.active").attr('id');setTimeout(function(){loadSubnets(sectionId);parameter=null;},reloadTimeout);}});return false;});$('form#manageSubnetEditFromSubnets input.cancel').live('click',function(){$('div.content').slideUp('fast');});function loadAddSectionFromSubnets(postdata){$.post('site/admin/manageSubnetEdit.php',postdata,function(data){$('div.content').html(data).slideDown('fast');});}
$('img.add_ipaddress, img.edit_ipaddress, img.delete_ipaddress, img.add_ipaddress_lock').live("click",function(){action=$(this).attr('class');id=$(this).attr('id');subnetId=$('table.subnets tr.selected').attr('id');modifyipaddress(action,id,subnetId);});$('img.edit_subnet').live("click",function(){subnetId=$('table.subnets tr.selected').attr('id');sectionId=$('table.newSections li.active').attr('id');subnetAction="Edit";locationAction="IPaddresses";postdata="sectionId="+sectionId+"&subnetId="+subnetId+"&subnetAction="+subnetAction+"&location="+locationAction;$.post('site/admin/manageSubnetEdit.php',postdata,function(data){$('div.edit_subnet').html(data).addClass('edit_subnet').slideDown('fast');});});$('img.mail_ipaddress').live("click",function(){var IPid=$(this).attr('id');$('.tooltipTop').hide();$.post('site/mailNotifyIP.php',{id:IPid},function(data){$('div.addnew').html(data).addClass('mail').slideDown('fast');});});$('form#mailNotify').live('submit',function(){var mailData=$(this).serialize();$.post('site/mailNotifyCheck.php',mailData,function(data){$('div.sendmail_check').html(data).slideDown('fast');if(data.search("error")==-1){$('div.addnew').animate({opacity:'1.0'},1500).slideUp('fast');}});return false;});$('form#mailNotify input.cancel').live('click',function(){$('td.addnew').slideUp('fast');});$('form.editipaddress').live("submit",function(){modifyipaddresscheck();return false;});$('input.cancel').live('click',function(){$('div.addnew').slideUp('fast');});$('table.slaveSubnet tr[class!=th]').live('click',function(){var subnetId=$(this).attr('subnetId');$('table.subnets td.slaveSubnets tr').removeClass('selected');$('table.subnets td.slaveSubnets tr#'+subnetId).addClass('selected');loadipaddresses(subnetId);});$('table.admin tr[class!=th]').live("mouseover mouseout",function(event){if(event.type=='mouseover')
$(this).addClass('hover');else
$(this).removeClass('hover');});$('table.manageSection tr[class!=th], table.manageSubnets tr[class!=th]').live("mouseover mouseout",function(event){if(event.type=='mouseover')
$(this).addClass('hover');else
$(this).removeClass('hover');});$('table.admin tr[class!=th]').live('click',function(){subpage=$(this).attr("id");link=$(this).children('td').attr('link');document.location.href="#"+link;$('table.admin tr').removeClass('selected');$(this).addClass('selected');loadAdminSubpage(subpage);});$('#settings').live('submit',function(){var settings=$(this).serialize();$.post('site/admin/settingsEdit.php',settings,function(data){$('div.settingsEdit').html(data).slideDown('fast');setTimeout(function(){window.location.reload();},reloadTimeout);});return false;});$('img.sectionAdd, img.sectionDelete, img.sectionEdit').live("click",function(){action=$(this).attr('class');id=$(this).attr('id');$.post('site/admin/manageSectionEdit.php',{action:action,id:id},function(data){$('div.manageSectionEdit').html(data).slideDown('fast');});});$('form.sectionEdit').live('submit',function(){sectionDetails=$(this).serialize();$.post('site/admin/manageSectionEditResult.php',sectionDetails,function(data){$('div.sectionEditResult').hide().html(data).slideDown('fast');if(data.search("error")==-1){subpage=$('table.admin tr.selected').attr("id");setTimeout(function(){loadAdminSubpage(subpage);parameter=null;},reloadTimeout);setTimeout(reloadSections,reloadTimeout);}});return false;});$('input.cancelSectionEdit').live('click',function(){$('div.manageSectionEdit').slideUp('fast');});$('table.manageSubnets img').live('click',function(){sectionId=$(this).attr('sectionId');subnetId=$(this).attr('subnetId');subnetAction=$(this).attr('class');postdata="sectionId="+sectionId+"&subnetId="+subnetId+"&subnetAction="+subnetAction;$.post("site/admin/manageSubnetEdit.php",postdata,function(data){$('div.manageSubnetEdit').html(data).slideDown('fast');});});$('table.manageSubnets thead').live('click',function(){sectionId=$(this).attr('class');showManageSubnetsBody(sectionId);});$('form#manageSubnetEdit input.cancel').live('click',function(){$('div.manageSubnetEdit').slideUp('fast');});$('form#manageSubnetEdit').live('submit',function(){subnetData=$(this).serialize();$.post("site/admin/manageSubnetEditResult.php",subnetData,function(data){$('div.manageSubnetEditResult').html(data).slideDown('fast');if(data.search("error")==-1){showSpinner();subpage=$('table.admin tr.selected').attr("id");if(subnetData.search("IPaddresses")!=-1){subnetId=$('table.subnets tr.selected').attr('id');setTimeout(function(){loadipaddresses(subnetId);parameter=null;},reloadTimeout);}
else{setTimeout(function(){showManageSubnetsPageAndBody(subpage,sectionId);parameter=null;},reloadTimeout);}}});return false;});$('form#userMod').live('submit',function(){loginData=$(this).serialize();$.post('site/admin/userModResult.php',loginData,function(data){$('div.userModResult').html(data).slideDown('fast');if(data.search("error")==-1){setTimeout(loadUserModSubpage,reloadTimeout);}});return false;});$('a#randomPass').live('click',function(){password=randomPass();$('input.userPass').val(password);$(this).html(password);});$('table.userPrint td.edit img').live('click',function(){id=$(this).attr('id');action=$(this).attr('class');postdata="id="+id+"&action="+action;$.post('site/admin/userModPrint.php',postdata,function(data){$('div.userEditLoad').html(data).slideDown('fast');});});$('form#logs').live('change',function(){showSpinner();var logSelection=$('form#logs').serialize();$.post('site/admin/logResult.php',logSelection,function(data){$('table.logs').html(data);hideSpinner();});});$('form#logs input').live('click',function(){showSpinner();var logSelection=$('form#logs').serialize();var direction=$(this).attr('class');if(direction=="next"){var lastId=$('table.logs tr:last').attr('id');}
else{var lastId=$('table.logs tr:nth-child(2)').attr('id');}
postData=logSelection+"&direction="+direction+"&lastId="+lastId;$.post('site/admin/logResult.php',postData,function(data1){$('div.logs').html(data1);hideSpinner();});});$('table.logs tr[class!=th]').live("mouseover mouseout",function(event){if(event.type=='mouseover')
$(this).addClass('hover');else
$(this).removeClass('hover');});$('input#XLSdump').live('click',function(){$("div.dl").remove();$('div.exportDIV').append("<div style='display:none' class='dl'><iframe src='site/admin/exportGenerateXLS.php'></iframe></div>");});$('input#MySQLdump').live('click',function(){$("div.dl").remove();$('div.exportDIV').append("<div style='display:none' class='dl'><iframe src='site/admin/exportGenerateMySQL.php' ></iframe></div>");});$('#instructions').live('submit',function(){var instructions=$(this).serialize();showSpinner();$.post('site/admin/instructionsResult.php',instructions,function(data){$('div.instructionsResult').html(data).fadeIn('fast');hideSpinner();setTimeout(function(){loadAdminSubpage("instructions");parameter=null;},reloadTimeout);});return false;});$('#preview').live('click',function(){var instructions=$('form#instructions ').serialize();showSpinner();$.post('site/admin/instructionsPreview.php',instructions,function(data){$('div.instructionsPreview').html(data).fadeIn('fast');hideSpinner();});return false;});$('table.requestedIPaddresses img').live('click',function(){showSpinner();var requestId=$(this).attr('requestId');$.post('site/admin/manageRequestEdit.php',{requestId:requestId},function(data){$('div.manageRequestEdit').html(data).fadeIn('fast');hideSpinner();});return false;});$('form.manageRequestEdit').live('submit',function(){showSpinner();postValues=$(this).serialize();postData=postValues+"&action=confirmed";$.post('site/admin/manageRequestResult.php',postData,function(data){$('div.manageRequestResult').html(data);hideSpinner();if(data.search("error")==-1){setTimeout(loadAdminIPRequestSubpage,reloadTimeout);}});return false;});$('form.manageRequestEdit .reject').live('click',function(){showSpinner();postValues=$('form.manageRequestEdit').serialize();postData=postValues+"&action=reject";$.post('site/admin/manageRequestResult.php',postData,function(data){$('div.manageRequestResult').html(data);hideSpinner();if(data.search("error")==-1){setTimeout(loadAdminIPRequestSubpage,reloadTimeout);}});return false;});$('ul.topNav li').live("mouseover mouseout",function(event){if(event.type=='mouseover')
$(this).addClass('hover');else
$(this).removeClass('hover');});$('ul.topNav li[id!=search], ul.subNav li').live('click',function(){$('td#subnets').slideDown();var link=$(this).attr('link');document.location.href="#"+link;subPage=$(this).attr('id');loadToolsMenu(subPage);$('table.newSections li').removeClass('active');$('table.menu tr').removeClass('selected');setTimeout(function(){loadToolsSubpage(subPage);parameter=null;},100);});$('table.menu a').live('click',function(){subPage=$(this).attr('id');loadToolsSubpage(subPage);});$('form#ipCalc').live('submit',function(){var ipCalcData=$(this).serialize();showSpinner();$.post('site/tools/ipCalcResult.php',ipCalcData,function(data){$('div.ipCalcResult').html(data).fadeIn('fast');hideSpinner();});return false;});$('form#ipCalc input.reset').live('click',function(){$('form#ipCalc input[type="text"]').val('');$('div.ipCalcResult').slideUp('fast');});$('table.vlans tr.vlanLink').live('click',function(){var sectionId=$(this).attr('sectionId');var subnetId=$(this).attr('subnetId');var link=$(this).attr('link');document.location.href="#"+link;$('table.newSections li#'+sectionId).addClass('active');hashLoadSubnets(sectionId,subnetId);});$('table.switches tr[class!=th]').live('click',function(){var sectionId=$(this).attr('sectionId');var subnetId=$(this).attr('subnetId');var link=$(this).attr('link');var id=$(this).attr('id');document.location.href="#"+link;$('table.newSections li#'+sectionId).addClass('active');hashLoadSubnets(sectionId,subnetId);setTimeout(function(){modifyipaddress("edit",id,subnetId);parameter=null;},1000);});$('#hosts').live('submit',function(){var hostname=$('input#hostsFilter').val();showSpinner();$.post('site/tools/hostsResult.php',{hostname:hostname},function(data){$('div.hostsFilterResult').html(data).fadeIn('fast');hideSpinner();});return false;});$('table.hosts tr[class!=th]').live('click',function(){var sectionId=$(this).attr('sectionId');var subnetId=$(this).attr('subnetId');var link=$(this).attr('link');var id=$(this).attr('id');document.location.href="#"+link;$('table.newSections li#'+sectionId).addClass('active');hashLoadSubnets(sectionId,subnetId);setTimeout(function(){modifyipaddress("edit",id,subnetId);parameter=null;},1000);});$('form#userModSelf').live('submit',function(){var selfdata=$(this).serialize();$('div.userModSelfResult').hide();$.post('site/tools/userMenuSelfMod.php',selfdata,function(data){$('div.userModSelfResult').html(data).fadeIn('fast');if(data.search("error")==-1){setTimeout(function(){loadToolsSubpage("userMenu");parameter=null;},reloadTimeout);}});return false;});$('a#randomPassSelf').live('click',function(){password=randomPass();$('input.userPass').val(password);$(this).html(password);return false;});$("ul.topNav li#userMenu").hover(function(){$(this).parent().find("ul.subNav").slideDown('fast').show();$(this).css('color: white');$(this).parent().hover(function(){},function()
{$(this).parent().find("ul.subNav").slideUp('fast');$(this).stop();});});$('form#userMenuSearch input[type=text]').live('click',function(){$(this).val('');});$('form#userMenuSearch').live('submit',function(){searchTerm=$(this).serialize();loadSearchPage(searchTerm);return false;});$('table.homeStats td.HomeManage input').live('click',function(){section2='Administration';var subpage=$(this).attr('name');hashLoadAdmin(section2,subpage);});$('table.homeStats td.HomeTools input').live('click',function(){var subpage=$(this).attr('name');loadToolsMenuAndSubpage(subpage);});$('form#homeIPSearch').live('submit',function(){var searchTerm=$(this).serialize();loadSearchPage(searchTerm);return false;});$('form#search').live('submit',function(){var searchTerm=$(this).serialize();updateSearchPage(searchTerm);return false;});$('table.homeStats a.instructions, table.homeStats img.instructions').live('click',function(){loadToolsMenuAndSubpage("instructions");});$('#adminRequestNotif').live('click',function(){hashLoadAdmin("Administration","manageRequests");});return false;});